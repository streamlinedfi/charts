{"version":3,"sources":["../src/BarChart/Chart.js","../src/BarChart/components/ControlSlider.js","../src/BarChart/modules/preventScroll.js","../src/BarChart/modules/useSize.js","../src/BarChart/components/Header.js","../src/BarChart/components/konva/index.js","../src/BarChart/modules/useContext.js","../src/BarChart/components/Text.js","../src/BarChart/modules/removeNilDeep.js","../src/BarChart/components/InnerChart.js","../src/BarChart/modules/getBarCoordinate.js","../src/BarChart/modules/getZOrderedDatasets.js","../src/BarChart/modules/useRenderer.js","../src/BarChart/components/Crosshair.js","../src/BarChart/components/YTick.js","../src/BarChart/components/LineDrawings.js","../src/BarChart/components/Menu.js","../src/BarChart/components/MobileDivOverlay.js","../src/BarChart/components/XAxis.js","../src/BarChart/components/YAxis.js","../src/BarChart/modules/useCallbacks.js","../src/BarChart/modules/useConfig.js","../src/BarChart/modules/defaultConfig.js","../src/BarChart/modules/normalizeData.js","../src/BarChart/modules/useFrame.js","../src/BarChart/modules/useScales.js","../src/BarChart/modules/visibilityChange.js"],"sourcesContent":["import inRange from 'lodash/inRange';\nimport maxBy from 'lodash/maxBy';\nimport React, { useEffect, useRef, useState } from 'react';\nimport ControlSlider from './components/ControlSlider';\nimport Header from './components/Header';\nimport InnerChart from './components/InnerChart';\nimport { Layer, Rect, Stage } from './components/konva';\nimport MobileDivOverlay from './components/MobileDivOverlay';\nimport XAxis from './components/XAxis';\nimport YAxis from './components/YAxis';\nimport useCallbacks from './modules/useCallbacks';\nimport useConfig from './modules/useConfig';\nimport { Context } from './modules/useContext';\nimport useFrame from './modules/useFrame';\nimport useScales from './modules/useScales';\nimport onVisibilityChange from './modules/visibilityChange';\n\nfunction Chart({ fwdRef, title, data, config: cfg, slider }) {\n  const layerRef = useRef();\n  const [barData, setBarData] = useState(data);\n  const config = useConfig({ title, data: barData, ...cfg });\n  const frame = useFrame(config);\n  const scales = useScales(frame, config);\n  const [dispatch, on, off] = useCallbacks();\n  const [cursor, setCursor] = useState('default');\n  const [menuItems, setMenuItems] = useState({});\n  const [activeScale, setActiveScale] = useState(0);\n  const [renderKey, setRenderKey] = useState(0);\n\n  // slider\n  const steps = maxBy(data, dataSeries => dataSeries?.series?.length)?.series\n    ?.length;\n  const [slices, setSlices] = useState(config.initSlices);\n  const [sliceStart, sliceEnd] = slices;\n\n  useEffect(() => {\n    setSlices(config.initSlices);\n  }, [steps]);\n\n  useEffect(() => {\n    setBarData(\n      [...(data || [])].map(dataSeries => {\n        return {\n          ...dataSeries,\n          series: [...(dataSeries?.series || [])].slice(\n            Math.max(0, steps + sliceStart),\n            steps + sliceEnd,\n          ),\n        };\n      }),\n    );\n  }, [data, sliceStart, sliceEnd]);\n\n  useEffect(() => {\n    let renderCount = 0;\n    onVisibilityChange(visible => {\n      if (visible) {\n        // trigger state change to force rerender on window focus\n        // to fix empty chart phenomenon\n        setRenderKey(renderCount++);\n      }\n    });\n  }, []);\n\n  const context = {\n    config,\n    frame,\n    scales,\n    cursor,\n    setCursor,\n    activeScale,\n    setActiveScale,\n    dispatch,\n    on,\n    off,\n    menuItems,\n    setMenuItems,\n  };\n\n  const konvaEvent = e => ({\n    ...e,\n    inInnerChartRange:\n      inRange(e.evt.offsetX, frame.innerChart.xStart, frame.innerChart.xEnd) &&\n      inRange(e.evt.offsetY, frame.innerChart.yStart, frame.innerChart.yEnd),\n  });\n\n  return (\n    <div>\n      <Stage\n        key={renderKey}\n        ref={fwdRef}\n        width={config.width}\n        height={config.height}\n        style={{ cursor }}\n        onContextMenu={e => e.evt.preventDefault()}\n        onClick={e => dispatch('click', konvaEvent(e))}\n        onMouseDown={e => dispatch('mousedown', konvaEvent(e))}\n        onMouseUp={e => dispatch('mouseup', konvaEvent(e))}\n        onMouseMove={e => dispatch('mousemove', konvaEvent(e))}\n      >\n        <Context.Provider value={context}>\n          <Layer ref={layerRef}>\n            <Rect\n              x={0}\n              y={0}\n              width={config.width}\n              height={config.height}\n              fill={config.theme.bgColor}\n              cornerRadius={config.theme.borderRadius}\n            />\n            <Header />\n            <XAxis />\n            <YAxis />\n            <InnerChart layerRef={layerRef} />\n          </Layer>\n          <MobileDivOverlay />\n        </Context.Provider>\n      </Stage>\n      {slider && (\n        <div style={{ paddingTop: config.theme.slider.padding }}>\n          <ControlSlider\n            max={steps}\n            value={slices.map(v => v + steps)}\n            onInput={([min, max]) => {\n              setSlices([min - steps, max - steps]);\n            }}\n            theme={config.theme.slider}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Chart;\n","import Div from '@streamlinedfi/div';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { disableScroll, enableScroll } from '../modules/preventScroll';\nimport useSize from '../modules/useSize';\n\nconst Thumb = ({ left, right, value, scale, max, onMove, theme, ...props }) => {\n  const deltaRef = useRef();\n\n  const handleMouseMove = event => {\n    /* eslint-disable no-param-reassign */\n    if (deltaRef.current) {\n      const isTouch = event.type === 'touchmove';\n      deltaRef.current.deltaX =\n        (isTouch ? event.touches[0].clientX : event.clientX) -\n        deltaRef.current.initX;\n      const dx = deltaRef.current.deltaX;\n\n      if (left) {\n        const nextX = Math.min(Math.max(0, scale(value[0]) + dx), scale(max));\n        const nextValue = scale.invert(nextX);\n\n        onMove(\n          nextValue < value[1] ? [nextValue, value[1]] : [value[1], nextValue],\n        );\n      } else {\n        const nextX = Math.min(Math.max(0, scale(value[1]) + dx), scale(max));\n        const nextValue = scale.invert(nextX);\n\n        onMove(\n          nextValue > value[0] ? [value[0], nextValue] : [nextValue, value[0]],\n        );\n      }\n\n      if (window.getSelection) {\n        window.getSelection().removeAllRanges();\n      } else if (document.selection) {\n        document.selection.empty();\n      }\n    }\n  };\n\n  const handlePointerDown = event => {\n    const isTouch = event.type === 'touchstart';\n    deltaRef.current = {};\n    deltaRef.current.initX = isTouch ? event.touches[0].clientX : event.clientX;\n    disableScroll();\n\n    document.body.addEventListener(\n      isTouch ? 'touchmove' : 'mousemove',\n      handleMouseMove,\n    );\n\n    document.body.addEventListener(\n      isTouch ? 'touchend' : 'pointerup',\n      () => {\n        document.body.removeEventListener(\n          isTouch ? 'touchmove' : 'mousemove',\n          handleMouseMove,\n        );\n        deltaRef.current = null;\n        enableScroll();\n      },\n      { once: true },\n    );\n  };\n\n  return (\n    <Div\n      as=\"button\"\n      type=\"button\"\n      // role=\"slider\"\n      aria-label={`Slider Thumb ${left ? 'Lower' : 'Upper'}`}\n      $absolute\n      $flex\n      $top={-10}\n      $left={left ? -16 : undefined}\n      $right={right ? -16 : undefined}\n      $innerCenter\n      $w={32}\n      $h={32}\n      $radius={16}\n      $cursor=\"ew-resize\"\n      $background={theme.thumbBackground}\n      $border={theme.thumbBorder}\n      $boxShadow=\"0 0 2px 1px rgba(0, 0, 0, .3)\"\n      onMouseDown={handlePointerDown}\n      onTouchStart={handlePointerDown}\n      {...props}\n    >\n      <Div\n        $w={1.5}\n        $h={12}\n        $background={theme.thumbHandleLineColor}\n        $mr=\"2px\"\n      />\n      <Div $w={1.5} $h={12} $background={theme.thumbHandleLineColor} />\n    </Div>\n  );\n};\n\nexport default function ControlSlider({ max, value, onInput, theme }) {\n  const ref = useRef();\n  const scaleRef = useRef();\n  const [scaleLoaded, setScaleLoaded] = useState();\n  const [width] = useSize(ref);\n  const scale = scaleRef.current;\n  const [leftValue, rightValue] = value;\n\n  useEffect(() => {\n    if (width) {\n      import('d3-scale').then(({ scaleLinear }) => {\n        scaleRef.current = scaleLinear()\n          .domain([0, max])\n          .range([0, width]);\n\n        setScaleLoaded(true);\n      });\n    }\n  }, [max, width]);\n\n  return (\n    <Div $px={1}>\n      <Div\n        ref={ref}\n        $relative\n        $h={12}\n        $w=\"100%\"\n        $radius={theme.borderRadius}\n        $background={theme.background}\n        $border={theme.border}\n      >\n        {scaleLoaded && (\n          <Div\n            $absolute\n            $h={12}\n            $left={Math.max(0, scale(leftValue))}\n            $right={Math.min(width, width - scale(rightValue))}\n            $background={theme.filledTrackColor}\n            $border={theme.filledTrackBorderColor}\n          >\n            <Thumb\n              left\n              value={value}\n              scale={scale}\n              max={max}\n              onMove={onInput}\n              theme={theme}\n            />\n            <Thumb\n              right\n              value={value}\n              scale={scale}\n              max={max}\n              onMove={onInput}\n              theme={theme}\n            />\n          </Div>\n        )}\n      </Div>\n    </Div>\n  );\n}\n","const keys = { 37: 1, 38: 1, 39: 1, 40: 1 };\n\nfunction preventDefault(e) {\n  e.preventDefault();\n}\n\n// eslint-disable-next-line consistent-return\nfunction preventDefaultForScrollKeys(e) {\n  if (keys[e.keyCode]) {\n    preventDefault(e);\n    return false;\n  }\n}\n\n// modern Chrome requires { passive: false } when adding event\nlet supportsPassive = false;\ntry {\n  window.addEventListener(\n    'test',\n    null,\n    Object.defineProperty({}, 'passive', {\n      get() {\n        supportsPassive = true;\n      },\n    }),\n  );\n} catch (e) {}\n\nconst wheelOpt = supportsPassive ? { passive: false } : false;\nconst wheelEvent =\n  'onwheel' in document.createElement('div') ? 'wheel' : 'mousewheel';\n\nexport function disableScroll() {\n  window.addEventListener('DOMMouseScroll', preventDefault, false);\n  window.addEventListener(wheelEvent, preventDefault, wheelOpt);\n  window.addEventListener('touchmove', preventDefault, wheelOpt);\n  window.addEventListener('keydown', preventDefaultForScrollKeys, false);\n}\n\nexport function enableScroll() {\n  window.removeEventListener('DOMMouseScroll', preventDefault, false);\n  window.removeEventListener(wheelEvent, preventDefault, wheelOpt);\n  window.removeEventListener('touchmove', preventDefault, wheelOpt);\n  window.removeEventListener('keydown', preventDefaultForScrollKeys, false);\n}\n","/* eslint-disable consistent-return */\nimport get from 'lodash/get';\nimport { useEffect, useState } from 'react';\n\n// can be controlled using dep array or else use resize observer\nexport default function useSize(\n  ref,\n  dependencyArray = [],\n  fallback = typeof window !== 'undefined' && document.body,\n) {\n  const [size, setSize] = useState({});\n\n  useEffect(() => {\n    let observer;\n\n    const el = ref?.current || fallback;\n\n    if (el) {\n      setSize({\n        width: el.clientWidth,\n        height: el.clientHeight,\n      });\n\n      if (!dependencyArray.length) {\n        observer = new ResizeObserver(entries => {\n          // Wrap it in requestAnimationFrame to avoid this error - ResizeObserver loop limit exceeded\n          requestAnimationFrame(() => {\n            setSize({\n              width: get(entries, '0.target.clientWidth', 0),\n              height: get(entries, '0.target.clientHeight', 0),\n            });\n          });\n        });\n\n        observer.observe(el);\n      }\n    }\n\n    return () => {\n      if (observer) {\n        observer.disconnect();\n        observer = null;\n      }\n    };\n  }, [ref?.current, ...dependencyArray]);\n\n  return [size.width, size.height, size.breakpoints || {}];\n}\n","import React from 'react';\nimport { Group, Rect, Circle } from './konva';\nimport useContext from '../modules/useContext';\nimport Text from './Text';\n\nfunction Header() {\n  const { frame, config, setActiveScale, setCursor } = useContext();\n\n  return (\n    <>\n      <Text\n        text={config.title}\n        x={frame.header.xStart}\n        y={frame.header.yStart}\n        fontFamily={config.theme.title.fontFamily}\n        fontSize={config.theme.title.fontSize}\n        fill={config.theme.title.color}\n      />\n      {config.data\n        .map((dataset, index) => ({\n          dataset,\n          index,\n          xStart: frame.legend.items[index].xStart,\n          yStart: frame.legend.items[index].yStart,\n          color: config.theme.colors[index],\n        }))\n        .map(({ dataset, index, xStart, yStart, color }) => (\n          <Group\n            key={dataset.name + index}\n            onClick={\n              !config.sharedScale ? () => setActiveScale(index) : undefined\n            }\n            onMouseEnter={\n              !config.sharedScale ? () => setCursor('pointer') : undefined\n            }\n            onMouseLeave={\n              !config.sharedScale ? () => setCursor('default') : undefined\n            }\n          >\n            <Circle\n              x={xStart}\n              y={yStart + config.theme.legend.circle.positionTop}\n              radius={config.theme.legend.circle.size / 2}\n              offsetX={-config.theme.legend.circle.size / 2}\n              offsetY={-config.theme.legend.circle.size / 2}\n              stroke={color}\n              strokeWidth={config.theme.legend.circle.lineWidth}\n            />\n            <Rect\n              x={xStart + config.theme.legend.circle.size}\n              y={yStart}\n              width={config.theme.legend.circle.marginRight}\n              height={config.theme.legend.fontSize}\n            />\n            <Text\n              text={dataset.name}\n              x={\n                xStart +\n                config.theme.legend.circle.size +\n                config.theme.legend.circle.marginRight\n              }\n              y={yStart}\n              fontFamily={\n                config.theme.legend.fontFamily || config.theme.fontFamily\n              }\n              fontSize={config.theme.legend.fontSize}\n              fill={config.theme.legend.color}\n            />\n          </Group>\n        ))}\n    </>\n  );\n}\n\nexport default Header;\n","import React, { forwardRef } from 'react';\nimport {\n  Stage as KonvaStage,\n  Layer as KonvaLayer,\n  Group as KonvaGroup,\n  Rect as KonvaRect,\n  Circle as KonvaCircle,\n  Text as KonvaText,\n  Line as KonvaLine,\n  Image as KonvaImage,\n} from 'react-konva';\n\n// preventDefault to allow scrolling on mobile (touch)\nexport const Stage = forwardRef((props, ref) => (\n  <KonvaStage ref={ref} {...props} preventDefault={false} />\n));\nexport const Layer = forwardRef((props, ref) => (\n  <KonvaLayer ref={ref} {...props} preventDefault={false} />\n));\nexport const Group = forwardRef((props, ref) => (\n  <KonvaGroup ref={ref} {...props} preventDefault={false} />\n));\nexport const Rect = forwardRef((props, ref) => (\n  <KonvaRect ref={ref} {...props} preventDefault={false} />\n));\nexport const Circle = forwardRef((props, ref) => (\n  <KonvaCircle ref={ref} {...props} preventDefault={false} />\n));\nexport const Text = forwardRef((props, ref) => (\n  <KonvaText ref={ref} {...props} preventDefault={false} />\n));\nexport const Line = forwardRef((props, ref) => (\n  <KonvaLine ref={ref} {...props} preventDefault={false} />\n));\nexport const Image = forwardRef((props, ref) => (\n  <KonvaImage ref={ref} {...props} preventDefault={false} />\n));\n","import React, { useContext as useReactContext } from 'react';\n\nexport const Context = React.createContext();\n\nexport default function useContext() {\n  return useReactContext(Context);\n}\n","import Konva from 'konva';\nimport React, { forwardRef } from 'react';\nimport removeNilDeep from '../modules/removeNilDeep';\nimport useContext from '../modules/useContext';\nimport { Text as KonvaText, Rect } from './konva';\n\nfunction Text(props, ref) {\n  const { config } = useContext();\n\n  const textProps = {\n    fontFamily: config.theme.fontFamily,\n    fontSize: config.theme.fontSize,\n    fontStyle: config.theme.fontStyle,\n    fill: config.theme.color,\n    ...removeNilDeep(props),\n  };\n\n  function getWidth() {\n    return Math.ceil(new Konva.Text(textProps).getTextWidth());\n  }\n\n  return (\n    <>\n      {props.bgFill && (\n        <Rect\n          x={props.x}\n          y={props.y}\n          offsetX={props.bgPadding}\n          offsetY={props.bgPadding}\n          width={getWidth() + props.bgPadding * 2}\n          height={textProps.fontSize + props.bgPadding * 2}\n          fill={props.bgFill}\n        />\n      )}\n      <KonvaText ref={ref} {...textProps} />\n    </>\n  );\n}\n\nexport default forwardRef(Text);\n","import isNil from 'lodash/isNil';\n\nconst { fromEntries, entries } = Object;\n\nfunction removeNilDeep(entity) {\n  if (Array.isArray(entity)) {\n    return entity.map(removeNilDeep).filter(value => !isNil(value));\n  }\n\n  if (typeof entity === 'object' && !isNil(entity)) {\n    return fromEntries(\n      entries(entity)\n        .map(([key, value]) => [key, removeNilDeep(value)])\n        .filter(([key, value]) => !isNil(value)),\n    );\n  }\n\n  return entity;\n}\n\nexport default removeNilDeep;\n","import { mix } from 'polished';\nimport React, { useEffect, useRef } from 'react';\nimport getBarCoordinate from '../modules/getBarCoordinate';\nimport getZOrderedDatasets from '../modules/getZOrderedDatasets';\nimport useContext from '../modules/useContext';\nimport useRenderer from '../modules/useRenderer';\nimport Crosshair from './Crosshair';\nimport { Rect } from './konva';\nimport LineDrawings from './LineDrawings';\nimport Menu from './Menu';\n\nconst jstr = JSON.stringify;\n\nfunction renderLine({ stroke, strokeWidth, points }) {\n  return [\n    {\n      type: 'Line',\n      attrs: {\n        points,\n        stroke,\n        strokeWidth,\n        perfectDrawEnabled: false,\n        listening: false,\n      },\n    },\n  ];\n}\n\nfunction renderBar({ width, height, x, y, fill, cornerRadius }) {\n  return [\n    {\n      type: 'Rect',\n      attrs: {\n        x,\n        y,\n        width,\n        height,\n        fill,\n        cornerRadius,\n        perfectDrawEnabled: false,\n        listening: false,\n      },\n    },\n  ];\n}\n\nfunction InnerChart({ layerRef }) {\n  const renderer = useRenderer(layerRef.current);\n  const prevBarsRef = useRef([]);\n  const {\n    frame,\n    scales,\n    config,\n    activeScale,\n    setCursor,\n    dispatch,\n  } = useContext();\n  const data = getZOrderedDatasets(config, activeScale);\n\n  useEffect(() => {\n    renderer.destroyAll();\n\n    const barKeys = {};\n    data.forEach(([dataset, i]) => {\n      const scale = scales[config.sharedScale ? 0 : i];\n      const { barWidth, getBarX } = getBarCoordinate(config, scale);\n\n      dataset.series\n        .map(entry => {\n          const key = i + entry.x + entry.y;\n          barKeys[key] = key;\n\n          return {\n            ...entry,\n            key,\n          };\n        })\n        .forEach(({ key, x, y, color }, j) => {\n          if (j === 0) {\n            // remove bars that are no longer in the chart\n            prevBarsRef.current.forEach(prevKey => {\n              if (!barKeys[prevKey]) {\n                renderer.destroy(prevKey);\n              }\n            });\n\n            prevBarsRef.current = Object.keys(barKeys);\n          }\n\n          const isPositive = Number(y) >= 0;\n\n          if (!x) {\n            return;\n          }\n\n          renderer(renderBar, {\n            key,\n            x: getBarX(i, x),\n            width: barWidth,\n            fill:\n              color || mix(0.1, config.theme.bgColor, config.theme.colors[i]),\n            ...(isPositive\n              ? {\n                  y: scale.y(y),\n                  height: scale.y(0) - scale.y(y),\n                  cornerRadius: [\n                    config.theme.bar.borderRadius,\n                    config.theme.bar.borderRadius,\n                    0,\n                    0,\n                  ],\n                }\n              : {\n                  y: scale.y(0),\n                  height: scale.y(y) - scale.y(0),\n                  cornerRadius: [\n                    0,\n                    0,\n                    config.theme.bar.borderRadius,\n                    config.theme.bar.borderRadius,\n                  ],\n                }),\n          });\n        });\n\n      renderer(renderLine, {\n        stroke: config.theme.axes.lineColor,\n        strokeWidth: 1,\n        points: [\n          frame.innerChart.xStart,\n          scale.y(0),\n          frame.innerChart.xEnd,\n          scale.y(0),\n        ],\n      });\n    });\n\n    return () => {\n      renderer.destroyAll();\n    };\n  }, [dispatch, jstr(data)]);\n\n  return (\n    <>\n      <Rect\n        x={frame.innerChart.xStart}\n        y={frame.innerChart.yStart}\n        width={frame.innerChart.width}\n        height={frame.innerChart.height}\n        onMouseEnter={() => setCursor('crosshair')}\n        onMouseLeave={() => setCursor('default')}\n        onClick={event => {\n          dispatch('innerChartClick', event);\n        }}\n      />\n      <Crosshair />\n      <LineDrawings />\n      <Menu />\n    </>\n  );\n}\n\nexport default InnerChart;\n","export default function getBarCoordinate(config, scale) {\n  if (!scale) {\n    console.log(config);\n    console.log(scale);\n  }\n\n  const stepWidth =\n    scale.x.step() * (1 - config.theme.axes.xInnerSpacingBarMultiplier);\n  const bars = config.data.length;\n\n  const barSpace = Math.min(\n    Math.max(\n      config.theme.bar.minWidth,\n      (stepWidth / bars) * config.theme.bar.spaceMultiplier,\n    ),\n    config.theme.bar.maxSpace,\n  );\n  const barStepWidth = stepWidth / bars - barSpace;\n  const barWidth = Math.min(\n    Math.max(config.theme.bar.minWidth, barStepWidth),\n    config.theme.bar.maxWidth,\n  );\n\n  const getBarX = (datasetI, x) =>\n    scale.x(x) + (barWidth + barSpace) * datasetI;\n\n  return { barWidth, getBarX };\n}\n","export default function getZOrderedDatasets(config, activeScale) {\n  const zOrderedDatasets = config.data\n    .map((dataset, index) => [dataset, index])\n    .reverse();\n\n  // push topLastValueIndex to the end\n  zOrderedDatasets.push(\n    zOrderedDatasets.splice(\n      zOrderedDatasets.findIndex(([, i]) => i === activeScale),\n      1,\n    )[0],\n  );\n\n  return zOrderedDatasets;\n}\n","/* eslint-disable no-underscore-dangle */\nimport { useEffect, useRef, useCallback } from 'react';\nimport Konva from 'konva';\nimport useContext from './useContext';\n\nconst isValidCoordinate = value => {\n  return !Number.isNaN(value) && ![0, null, undefined].includes(value);\n};\n\nconst isValidNode = (type, attrs) => {\n  if (\n    type === 'Rect' &&\n    ![attrs.x, attrs.y, attrs.width, attrs.height].every(isValidCoordinate)\n  ) {\n    return false;\n  }\n\n  if (type === 'Line' && !attrs.points.every(isValidCoordinate)) {\n    return false;\n  }\n\n  if (\n    (type === 'Circle' || type === 'Text') &&\n    ![attrs.x, attrs.y].every(isValidCoordinate)\n  ) {\n    return false;\n  }\n\n  return true;\n};\n\nexport default function useRenderer(layer) {\n  const { config, frame } = useContext();\n  const queue = useRef([]);\n  const ref = useRef({});\n\n  const handleRender = useCallback(\n    (renderFn, props) => {\n      if (!props || !isValidNode(props.type, props)) {\n        return null;\n      }\n\n      const { key, show = true } = props;\n      const node = ref.current[key];\n\n      if (!show) {\n        if (node) {\n          node.destroy();\n          delete ref.current[key];\n        }\n        return null;\n      }\n\n      const children = renderFn({ config, frame, node, ...props }).filter(\n        child => child && isValidNode(child.type, child.attrs),\n      );\n\n      if (!children || !children.length) {\n        if (node) {\n          node.destroy();\n          delete ref.current[key];\n        }\n        return null;\n      }\n\n      // update\n      if (node) {\n        children.forEach((child, i) => {\n          try {\n            node.children[i].setAttrs(child.attrs);\n          } catch (e) {\n            //\n          }\n        });\n        return node;\n      }\n\n      // create new\n      const groupNode = new Konva.Group({ key });\n      children.forEach(child => {\n        const childNode = new Konva[child.type](child.attrs);\n        groupNode.add(childNode);\n      });\n      layer.add(groupNode);\n\n      ref.current[key] = groupNode;\n      return groupNode;\n    },\n    [layer?._id, JSON.stringify(frame)],\n  );\n\n  useEffect(() => {\n    if (layer?._id) {\n      queue.current.forEach(([renderFn, props]) => {\n        handleRender(renderFn, props);\n      });\n    }\n  }, [layer?._id]);\n\n  function renderer(renderFn, props) {\n    if (!layer?.add) {\n      queue.current.push([renderFn, props]);\n      return null;\n    }\n    return handleRender(renderFn, props);\n  }\n  renderer.destroy = key => {\n    if (ref.current[key]) {\n      ref.current[key].destroy();\n      delete ref.current[key];\n    }\n  };\n  renderer.destroyAll = () => {\n    Object.keys(ref.current).forEach(key => {\n      ref.current[key]?.destroy();\n      delete ref.current[key];\n    });\n  };\n\n  return renderer;\n}\n","import inRange from 'lodash/inRange';\nimport React, { useEffect, useState } from 'react';\nimport getBarCoordinate from '../modules/getBarCoordinate';\nimport useContext from '../modules/useContext';\nimport { Line } from './konva';\nimport Text from './Text';\nimport YTick from './YTick';\n\nconst id = 'crosshair';\n\nfunction isTouchDevice() {\n  return !!(\n    'ontouchstart' in window ||\n    navigator.maxTouchPoints > 0 ||\n    navigator.msMaxTouchPoints > 0\n  );\n}\n\nfunction getClosestBarByX(config, scales, x) {\n  const closest = {};\n\n  for (let di = 0; di < config.data.length; di++) {\n    const dataset = config.data[di];\n    const scale = scales[config.sharedScale ? 0 : di];\n    const { barWidth, getBarX } = getBarCoordinate(config, scale);\n\n    for (let i = 0; i < dataset.series.length; i++) {\n      const xStart = getBarX(di, dataset.series[i].x);\n      const xCenter = xStart + barWidth / 2;\n\n      const diff = Math.abs(xCenter - x);\n\n      if (!Object.keys(closest).length || diff < closest.diff) {\n        closest.dataset = i;\n        closest.i = i;\n        closest.diff = diff;\n        closest.x = xCenter;\n        closest.xText = dataset.series[i].x;\n        closest.y = scale.y(dataset.series[i].y);\n        closest.meta = dataset.series[i].meta;\n      } else {\n        // break;\n      }\n    }\n  }\n\n  return closest;\n}\n\nfunction Crosshair() {\n  const { scales, frame, config, activeScale, on, off, tool } = useContext();\n  const [pos, setPos] = useState({ x: null, y: null });\n  const [fixedPos, setFixedPos] = useState({ x: null, y: null });\n\n  let x = fixedPos.x || pos.x;\n  let y = fixedPos.y || pos.y;\n  let xText = '';\n\n  const xInRange =\n    !!x && inRange(x, frame.innerChart.xStart, frame.innerChart.xEnd);\n\n  // config.snap\n  if (xInRange) {\n    const closestPoint = getClosestBarByX(config, scales, x);\n\n    x = closestPoint.x;\n    xText = closestPoint.xText;\n    y = closestPoint.y;\n  }\n\n  // const xText = config.formatters.crosshair.x(\n  //   scaleBandInvert(scales[activeScale].x)(x),\n  // );\n  // const xText = 'a';\n  const yText = config.formatters.crosshair.y(scales[activeScale].y.invert(y));\n\n  useEffect(() => {\n    if (tool !== 'crosshair') {\n      setFixedPos({ x: null, y: null });\n    }\n  }, [tool]);\n\n  useEffect(() => {\n    on(\n      'mousemove',\n      ({ inInnerChartRange, evt }) => {\n        setPos({\n          x: inInnerChartRange ? evt.offsetX : null,\n          y: inInnerChartRange ? evt.offsetY : null,\n        });\n      },\n      id,\n    );\n\n    // @TODO\n    // on(\n    //   'click',\n    //   ({ inInnerChartRange, evt }) => {\n    //     if (evt.which === 1 && tool === 'crosshair' && !selectedLine) {\n    //       setFixedPos(\n    //         fixedPos.x\n    //           ? { x: null, y: null }\n    //           : {\n    //               x: inInnerChartRange ? evt.offsetX : null,\n    //               y: inInnerChartRange ? evt.offsetY : null,\n    //             },\n    //       );\n    //     }\n    //   },\n    //   id,\n    // );\n\n    return () => {\n      off('mousemove', id);\n      off('click', id);\n    };\n  }, [fixedPos, tool, setPos]);\n\n  if (!xInRange || isTouchDevice()) return null;\n\n  return (\n    <>\n      <Line\n        stroke={config.theme.crosshair.lineColor}\n        strokeWidth={1}\n        dash={config.theme.crosshair.lineDash}\n        points={[x, frame.innerChart.yStart, x, frame.innerChart.yEnd]}\n      />\n      <Line\n        stroke={config.theme.crosshair.tickColor}\n        strokeWidth={1}\n        points={[\n          x,\n          frame.xAxis.yStart,\n          x,\n          frame.xAxis.yStart + config.theme.axes.tickSize,\n        ]}\n      />\n      <Text\n        text={xText}\n        x={x}\n        y={\n          frame.xAxis.yStart +\n          config.theme.axes.tickSize +\n          config.theme.axes.tickMargin\n        }\n        fontSize={config.theme.axes.fontSize}\n        fill={config.theme.crosshair.color}\n        bgPadding={1}\n        bgFill={config.theme.bgColor}\n      />\n      <Line\n        stroke={config.theme.crosshair.lineColor}\n        strokeWidth={1}\n        dash={config.theme.crosshair.lineDash}\n        points={[frame.innerChart.xStart, y, frame.innerChart.xEnd, y]}\n      />\n      <YTick y={y} text={yText} fill={config.theme.crosshair.color} />\n    </>\n  );\n}\n\nexport default Crosshair;\n","import React from 'react';\nimport { mix } from 'polished';\nimport { Group, Line } from './konva';\nimport useContext from '../modules/useContext';\nimport Text from './Text';\n\nfunction YTick({ y, text, fill, onClick }) {\n  const { frame, config, setCursor } = useContext();\n  const bgSize = config.theme.axes.lastValueTickBgSize;\n\n  return (\n    <Group\n      onClick={onClick}\n      onMouseEnter={onClick ? () => setCursor('pointer') : undefined}\n      onMouseLeave={onClick ? () => setCursor('default') : undefined}\n    >\n      <Line\n        fill={mix(0.2, fill, config.theme.bgColor)}\n        points={[\n          frame.yAxis.xStart,\n          y,\n          frame.yAxis.xStart + bgSize / 2,\n          y - bgSize / 2,\n          frame.yAxis.xEnd,\n          y - bgSize / 2,\n          frame.yAxis.xEnd,\n          y + bgSize / 2,\n          frame.yAxis.xStart + bgSize / 2,\n          y + bgSize / 2,\n          frame.yAxis.xStart,\n          y,\n        ]}\n        closed\n      />\n      <Line\n        stroke={fill}\n        strokeWidth={1}\n        points={[\n          frame.yAxis.xStart,\n          y,\n          frame.yAxis.xStart + config.theme.axes.tickSize,\n          y,\n        ]}\n      />\n      <Text\n        text={text}\n        x={\n          frame.yAxis.xStart +\n          config.theme.axes.tickSize +\n          config.theme.axes.tickMargin\n        }\n        y={y + 1}\n        offsetY={config.theme.axes.fontSize / 2}\n        fill={fill}\n        fontSize={config.theme.axes.fontSize}\n      />\n    </Group>\n  );\n}\n\nexport default YTick;\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Group, Circle, Line } from './konva';\nimport useContext from '../modules/useContext';\n\nconst { keys, values, fromEntries, entries } = Object;\n\nconst id = 'linedrawings';\n\nfunction LineDrawing({\n  line,\n  selectedLine,\n  setSelectedLine,\n  setMovingLine,\n  mousePos,\n}) {\n  const { frame, config, setCursor } = useContext();\n  const [isHovering, setIsHovering] = useState(false);\n\n  let points = [];\n  if (line.type === 'line') {\n    points = line.points[2]\n      ? line.points\n      : [line.points[0], line.points[1], mousePos.x, mousePos.y];\n  }\n\n  if (line.type === 'vline') {\n    points = [\n      line.points[0],\n      frame.innerChart.yStart,\n      line.points[0],\n      frame.innerChart.yEnd,\n    ];\n  }\n\n  if (line.type === 'hline') {\n    points = [\n      frame.innerChart.xStart,\n      line.points[1],\n      frame.innerChart.xEnd,\n      line.points[1],\n    ];\n  }\n\n  return (\n    <Group\n      onMouseEnter={() => {\n        setCursor('grab');\n        setIsHovering(true);\n      }}\n      onMouseLeave={() => {\n        setCursor('default');\n        setIsHovering(false);\n      }}\n      onClick={() => {\n        setSelectedLine(line.id);\n      }}\n    >\n      {(line.type !== 'line' || line.points[2]) && (\n        <Line\n          stroke=\"transparent\"\n          strokeWidth={config.theme.lineCircleSize}\n          points={points}\n          onMouseDown={() => {\n            setMovingLine([line.id, 'both']);\n          }}\n        />\n      )}\n      <Line\n        stroke={line.stroke}\n        strokeWidth={line.strokeWidth}\n        points={points}\n      />\n      {(selectedLine === line.id || isHovering) && (\n        <>\n          <Circle\n            x={line.points[0]}\n            y={line.points[1]}\n            radius={config.theme.lineCircleSize / 2}\n            fill={config.theme.bgColor}\n            stroke={line.stroke}\n            strokeWidth={line.strokeWidth}\n            onMouseDown={() => {\n              setMovingLine([line.id, 0]);\n            }}\n          />\n          {line.type === 'line' && line.points[2] && (\n            <Circle\n              x={line.points[2]}\n              y={line.points[3]}\n              radius={config.theme.lineCircleSize / 2}\n              fill={config.theme.bgColor}\n              stroke={line.stroke}\n              strokeWidth={line.strokeWidth}\n              onMouseDown={() => {\n                setMovingLine([line.id, 1]);\n              }}\n            />\n          )}\n        </>\n      )}\n    </Group>\n  );\n}\n\nfunction LineDrawings() {\n  const {\n    tool,\n    setTool,\n    config,\n    setCursor,\n    on,\n    off,\n    menuItems,\n    setMenuItems,\n  } = useContext();\n  const mouseDeltaRef = useRef();\n  const [mousePos, setMousePos] = useState({});\n  const [lines, setLines] = useState({});\n  const [selectedLine, setSelectedLine] = useState(null);\n  const [movingLine, setMovingLine] = useState(null);\n  const eventsActive = ['line', 'hline', 'vline'].includes(tool);\n\n  const addLine = useCallback(\n    (x, y) => {\n      const lastLineId = keys(lines)\n        .sort()\n        .reverse()[0];\n      const lastLine = lines[lastLineId];\n\n      if (!lastLine || lastLine.type !== 'line' || lastLine.points[2]) {\n        const lineId = Date.now();\n        setLines({\n          ...lines,\n          [lineId]: {\n            id: lineId,\n            type: tool,\n            stroke: config.theme.lineColor,\n            strokeWidth: config.theme.lineWidth,\n            points: [x, y],\n          },\n        });\n        setSelectedLine(lineId);\n        if (tool !== 'line') {\n          setTool('crosshair');\n        }\n      } else {\n        setLines({\n          ...lines,\n          [lastLine.id]: {\n            ...lastLine,\n            stroke: config.theme.lineColor,\n            strokeWidth: config.theme.lineWidth,\n            points: [...lastLine.points, x, y],\n          },\n        });\n        setTool('crosshair');\n      }\n    },\n    [lines, tool],\n  );\n\n  const moveLine = useCallback(\n    (x, y) => {\n      const [lineId, point] = movingLine;\n      const line = lines[lineId];\n      let points = [x, y];\n\n      if (line.type === 'line') {\n        if (point === 'both') {\n          const deltaRef = mouseDeltaRef.current;\n          if (!deltaRef.points) {\n            deltaRef.points = line.points;\n          }\n\n          points = [\n            deltaRef.points[0] + x - deltaRef.x,\n            deltaRef.points[1] + y - deltaRef.y,\n            deltaRef.points[2] + x - deltaRef.x,\n            deltaRef.points[3] + y - deltaRef.y,\n          ];\n        } else if (point === 0) {\n          points = [x, y, line.points[2], line.points[3]];\n        } else if (point === 1) {\n          points = [line.points[0], line.points[1], x, y];\n        }\n      }\n\n      setLines({\n        ...lines,\n        [line.id]: {\n          ...line,\n          points,\n        },\n      });\n    },\n    [lines, movingLine],\n  );\n\n  useEffect(() => {\n    on(\n      'mousemove',\n      ({ inInnerChartRange, evt }) => {\n        if (inInnerChartRange) {\n          const x = evt.offsetX;\n          const y = evt.offsetY;\n          setMousePos({ x, y });\n          if (movingLine) {\n            moveLine(x, y);\n          }\n        }\n      },\n      id,\n    );\n\n    return () => {\n      off('mousemove', id);\n    };\n  }, [movingLine, moveLine]);\n\n  useEffect(() => {\n    on(\n      'mousedown',\n      ({ evt }) => {\n        mouseDeltaRef.current = { x: evt.offsetX, y: evt.offsetY };\n      },\n      id,\n    );\n\n    return () => {\n      off('mousedown', id);\n    };\n  }, []);\n\n  useEffect(() => {\n    on(\n      'mouseup',\n      () => {\n        mouseDeltaRef.current = {};\n        setMovingLine(null);\n      },\n      id,\n    );\n\n    return () => {\n      off('mouseup', id);\n    };\n  }, []);\n\n  useEffect(() => {\n    on(\n      'innerChartClick',\n      ({ evt }) => {\n        setSelectedLine(null);\n        if (eventsActive) {\n          addLine(evt.offsetX, evt.offsetY);\n        }\n      },\n      id,\n    );\n\n    return () => {\n      off('innerChartClick', id);\n    };\n  }, [addLine, eventsActive]);\n\n  useEffect(() => {\n    const removePendingLine = event => {\n      if (['Escape', 'Backspace', 'Delete'].includes(event.key)) {\n        const pendingLine = values(lines).find(\n          line => line.type === 'line' && !line.points[2],\n        );\n        if (pendingLine) {\n          setLines(\n            fromEntries(\n              entries(lines).filter(([lineId]) => lineId !== pendingLine.id),\n            ),\n          );\n        }\n      }\n    };\n\n    document.addEventListener('keydown', removePendingLine);\n\n    return () => {\n      document.removeEventListener('keydown', removePendingLine);\n    };\n  }, [lines]);\n\n  useEffect(() => {\n    if (movingLine) {\n      setCursor('grabbing');\n    }\n  }, [movingLine]);\n\n  useEffect(() => {\n    if (keys(lines).length) {\n      setMenuItems({\n        ...menuItems,\n        removeSelected:\n          selectedLine !== null\n            ? {\n                text: 'Remove Drawing',\n                onClick: () => {\n                  setLines(\n                    fromEntries(\n                      entries(lines).filter(\n                        ([lineId]) => lineId !== selectedLine,\n                      ),\n                    ),\n                  );\n                },\n              }\n            : null,\n        removeAll: {\n          text: 'Remove All Drawings',\n          onClick: () => setLines([]),\n        },\n      });\n    } else {\n      setMenuItems({\n        ...menuItems,\n        removeSelected: null,\n        removeAll: null,\n      });\n    }\n  }, [JSON.stringify(menuItems), JSON.stringify(lines), selectedLine]);\n\n  return values(lines).map(line => (\n    <LineDrawing\n      key={line.i}\n      line={line}\n      selectedLine={selectedLine}\n      setSelectedLine={setSelectedLine}\n      setMovingLine={setMovingLine}\n      mousePos={mousePos}\n    />\n  ));\n}\n\nexport default LineDrawings;\n","import React, { useState, useEffect } from 'react';\nimport { Group, Rect } from './konva';\nimport useContext from '../modules/useContext';\nimport Text from './Text';\n\nconst id = 'menu';\n\nfunction MenuItem({ x, y, children, onClick }) {\n  const { config, setCursor } = useContext();\n  const [isHover, setIsHover] = useState(false);\n\n  return (\n    <Group\n      onMouseEnter={() => {\n        setIsHover(true);\n        setCursor('pointer');\n      }}\n      onMouseLeave={() => {\n        setIsHover(false);\n        setCursor('default');\n      }}\n      onClick={onClick}\n    >\n      <Rect\n        x={x}\n        y={y}\n        width={180 - 4 - 4}\n        height={\n          config.theme.menu.item.fontSize + config.theme.menu.item.padding * 2\n        }\n        fill={isHover ? config.theme.menu.item.bgColorHover : 'transparent'}\n        cornerRadius={config.theme.menu.item.borderRadius}\n      />\n      <Text\n        text={children}\n        x={x + config.theme.menu.item.padding}\n        y={y + config.theme.menu.item.padding}\n        fontSize={config.theme.menu.item.fontSize}\n        fill={\n          isHover\n            ? config.theme.menu.item.colorHover\n            : config.theme.menu.item.color\n        }\n      />\n    </Group>\n  );\n}\n\nfunction Menu() {\n  const { config, on, off, menuItems } = useContext();\n  const [pos, setPos] = useState();\n  const [show, setShow] = useState(false);\n\n  const itemHeight =\n    config.theme.menu.item.fontSize + config.theme.menu.item.padding * 2;\n  const items = Object.values(menuItems).filter(Boolean);\n\n  const width = 180;\n\n  useEffect(() => {\n    on(\n      'click',\n      e => {\n        // left click\n        if (show && e.evt.which === 1) {\n          setShow(false);\n        }\n\n        // right click\n        if (e.inInnerChartRange && e.evt.which === 3 && items.length) {\n          setShow(true);\n          setPos({ x: e.evt.offsetX, y: e.evt.offsetY });\n        }\n      },\n      id,\n    );\n\n    return () => {\n      off('click', id);\n    };\n  }, [show, pos, items.length]);\n\n  if (!show || !pos) {\n    return null;\n  }\n\n  const { x, y } = pos;\n\n  return (\n    <>\n      <Rect\n        x={x}\n        y={y}\n        width={width}\n        height={config.theme.menu.padding * 2 + itemHeight * items.length}\n        stroke={config.theme.menu.borderColor}\n        strokeWidth={config.theme.menu.borderWidth}\n        fill={config.theme.menu.bgColor}\n        cornerRadius={config.theme.menu.borderRadius}\n      />\n      {items.map((menuItem, i) => (\n        <MenuItem\n          height={itemHeight}\n          x={x + config.theme.menu.padding}\n          y={y + config.theme.menu.padding + itemHeight * i}\n          onClick={menuItem.onClick}\n        >\n          {menuItem.text}\n        </MenuItem>\n      ))}\n    </>\n  );\n}\n\nexport default Menu;\n","import React from 'react';\nimport { Html } from 'react-konva-utils';\nimport useContext from '../modules/useContext';\nimport { Layer } from './konva';\n\nexport default function MobileDivOverlay() {\n  const { config } = useContext();\n  const isMobile =\n    typeof window !== 'undefined' && typeof document !== 'undefined'\n      ? document.body.clientWidth < config.mobileThreshold\n      : false;\n\n  // tmp solution to allow scrolling on mobile\n  // touch seems to be prevented on canvas\n  if (isMobile) {\n    return (\n      <Layer>\n        <Html divProps={{ style: { zIndex: 1, width: '100%' } }}>\n          <div\n            style={{\n              position: 'absolute',\n              left: 0,\n              top: 0,\n              width: config.width,\n              height: config.height,\n            }}\n          />\n        </Html>\n      </Layer>\n    );\n  }\n\n  return null;\n}\n","import React, { useRef } from 'react';\nimport Konva from 'konva';\nimport { Group, Line } from './konva';\nimport useContext from '../modules/useContext';\nimport Text from './Text';\n\nfunction XAxis() {\n  const { frame, config, scales, activeScale } = useContext();\n  const xTickxEnd = useRef(frame.xAxis.xStart);\n\n  return (\n    <>\n      {config.data[activeScale].series.map((entry, i) => {\n        const x = scales[activeScale].x(entry.x);\n\n        if (i > 0 && x < xTickxEnd.current + config.theme.axes.minTickSpaceX) {\n          return;\n        }\n\n        const text = config.formatters.axes.x(entry.x);\n        xTickxEnd.current =\n          x +\n          new Konva.Text({\n            text,\n            fontFamily: config.theme.axes.fontFamily || config.theme.fontFamily,\n            fontStyle: 500,\n            fontSize: config.theme.axes.fontSize,\n          }).getTextWidth();\n\n        // eslint-disable-next-line consistent-return\n        return (\n          <Group key={entry.x}>\n            {config.theme.grid.showX && (\n              <Line\n                points={[x, frame.innerChart.yStart, x, frame.innerChart.yEnd]}\n                stroke={config.theme.grid.lineColor}\n                strokeWidth={1}\n              />\n            )}\n            <Line\n              points={[\n                x,\n                frame.xAxis.yStart,\n                x,\n                frame.xAxis.yStart + config.theme.axes.tickSize,\n              ]}\n              stroke={config.theme.axes.tickColor}\n              strokeWidth={1}\n            />\n            <Text\n              text={text}\n              x={x}\n              y={\n                frame.xAxis.yStart +\n                config.theme.axes.tickSize +\n                config.theme.axes.tickMargin\n              }\n              fontSize={config.theme.axes.fontSize}\n              fill={config.theme.axes.color}\n            />\n          </Group>\n        );\n      })}\n    </>\n  );\n}\n\nexport default XAxis;\n","import React, { useRef } from 'react';\nimport { Group, Line } from './konva';\nimport getZOrderedDatasets from '../modules/getZOrderedDatasets';\nimport useContext from '../modules/useContext';\nimport Text from './Text';\nimport YTick from './YTick';\n\nfunction YAxis() {\n  const { frame, config, scales, activeScale, setActiveScale } = useContext();\n  const yTickyEnd = useRef(config.height);\n\n  return (\n    <>\n      {scales[activeScale].y.ticks().map((tick, i) => {\n        const y = scales[activeScale].y(tick);\n\n        if (i > 0 && y > yTickyEnd.current - config.theme.axes.minTickSpaceY) {\n          return;\n        }\n\n        yTickyEnd.current = y - config.theme.axes.fontSize;\n\n        // eslint-disable-next-line consistent-return\n        return (\n          <Group key={tick}>\n            {config.theme.grid.showY && (\n              <Line\n                points={[frame.innerChart.xStart, y, frame.innerChart.xEnd, y]}\n                stroke={config.theme.grid.lineColor}\n                strokeWidth={1}\n              />\n            )}\n            <Line\n              points={[\n                frame.yAxis.xStart,\n                y,\n                frame.yAxis.xStart + config.theme.axes.tickSize,\n                y,\n              ]}\n              stroke={config.theme.axes.tickColor}\n              strokeWidth={1}\n            />\n            <Text\n              text={config.formatters.axes.y(tick)}\n              fontSize={config.theme.axes.fontSize}\n              fill={config.theme.axes.color}\n              x={\n                frame.yAxis.xStart +\n                config.theme.axes.tickSize +\n                config.theme.axes.tickMargin\n              }\n              y={y + 1}\n              offsetY={config.theme.axes.fontSize / 2}\n            />\n          </Group>\n        );\n      })}\n      {getZOrderedDatasets(config, activeScale).map(([dataset, index]) => {\n        const lastValue = dataset.series[dataset.series.length - 1];\n        if (!lastValue) return null;\n\n        const lastY = scales[config.sharedScale ? 0 : index].y(lastValue.y);\n\n        return (\n          <YTick\n            key={dataset.name + index}\n            y={lastY}\n            text={config.formatters.axes.y(lastValue.y)}\n            fill={config.theme.colors[index]}\n            onClick={\n              !config.sharedScale ? () => setActiveScale(index) : undefined\n            }\n          />\n        );\n      })}\n      <Line\n        stroke={config.theme.axes.lineColor}\n        strokeWidth={1}\n        points={[\n          frame.xAxis.xStart,\n          frame.xAxis.yStart,\n          frame.xAxis.xEnd,\n          frame.xAxis.yStart,\n        ]}\n      />\n      <Line\n        stroke={config.theme.axes.lineColor}\n        strokeWidth={1}\n        points={[\n          frame.yAxis.xStart,\n          frame.yAxis.yStart,\n          frame.yAxis.xStart,\n          frame.yAxis.yEnd,\n        ]}\n      />\n    </>\n  );\n}\n\nexport default YAxis;\n","import { useRef } from 'react';\n\nconst { values, keys } = Object;\n\n/**\n * useCallbacks\n * @returns [on,dispatch]\n */\nfunction useCallbacks() {\n  const callbacks = useRef({});\n  const dispatch = (event, payload) => {\n    values(callbacks.current[event] || [])\n      .filter(fn => typeof fn === 'function')\n      .forEach(fn => fn(payload));\n  };\n  const on = (event, callback, id) => {\n    const key = id || keys(callbacks.current).length;\n    callbacks.current[event] = {\n      ...callbacks.current[event],\n      [key]: callback,\n    };\n  };\n  const off = (event, id) => {\n    delete callbacks.current[event][id];\n  };\n  return [dispatch, on, off];\n}\n\nexport default useCallbacks;\n","import deepmerge from 'deepmerge';\nimport defaultConfig from './defaultConfig';\nimport normalizeData from './normalizeData';\nimport removeNilDeep from './removeNilDeep';\n\nexport default function useConfig(instanceConfig) {\n  const config = deepmerge(defaultConfig, removeNilDeep(instanceConfig));\n  config.data = normalizeData(config);\n\n  return config;\n}\n","import round from 'lodash/round';\nimport moment from 'moment-timezone';\nimport { transparentize } from 'polished';\n\nconst theme = {\n  fontFamily: '-apple-system,BlinkMacSystemFont,\"Helvetica Neue\",sans-serif',\n  colorMap: {\n    '0': '#0094FF',\n    '1': '#4db705',\n    '2': '#d6c103',\n    '3': '#e3482d',\n    '4': '#e21de7',\n  },\n  primary: '#0094FF',\n  greenCandle: '#24C1B0',\n  redCandle: '#FF5959',\n  fill900: '#F5F7FB',\n  fill800: '#E7EBFA',\n  fill700: '#CAD3ED',\n  fill600: '#ADB7D3',\n  fill500: '#95A0BF',\n  fill400: '#7D88AA',\n  fill300: '#4A5169',\n  fill200: '#3E4459',\n  fill100: '#313747',\n  border: '#3E4459',\n  background: '#232936',\n  backgroundDarker: '#1d222d',\n  backgroundDarkest: '#181c25',\n};\n\nexport default {\n  title: '',\n  xKey: 'x',\n  yKey: 'y',\n  formatters: {\n    axes: {\n      x: value => moment.tz(value, 'America/New_York').format('MMM YY'),\n      y: (value, decimals) => round(value, decimals).toFixed(decimals),\n    },\n    crosshair: {\n      x: value =>\n        moment.tz(value, 'America/New_York').format('D MMM YY HH:mm'),\n      y: (value, decimals) => round(value, decimals).toFixed(decimals),\n    },\n  },\n  mobileThreshold: 768,\n  initSlices: [-16, 0],\n  theme: {\n    colors: Object.values(theme.colorMap),\n    bgColor: theme.backgroundDarker,\n    borderRadius: 8,\n    lineColor: theme.primary,\n    lineWidth: 1.5,\n    lineCircleSize: 10,\n    fontFamily: theme.fontFamily,\n    fontSize: 14,\n    fontStyle: 500,\n    color: theme.fill600,\n    padding: 24,\n    title: {\n      fontSize: 14,\n      marginBottom: 12,\n      color: theme.fill800,\n    },\n    legend: {\n      fontSize: 13,\n      color: theme.fill600,\n      itemMarginRight: 12,\n      itemMarginBottom: 8,\n      marginBottom: 12,\n      circle: {\n        positionTop: -1,\n        size: 13,\n        marginRight: 6,\n        lineWidth: 1.5,\n      },\n    },\n    grid: {\n      lineColor: theme.fill100,\n      showY: true,\n      showX: false,\n    },\n    axes: {\n      fontSize: 13,\n      color: theme.fill500,\n      lineColor: theme.fill300,\n      tickColor: theme.fill300,\n      // tickBgColor: mix(0.2, theme.primary, theme.backgroundDarker),\n      tickSize: 8,\n      tickMargin: 4,\n      lastValueTickBgSize: 20,\n      lastValueYAxisGap: 16,\n      minTickSpaceX: 8,\n      minTickSpaceY: 8,\n      xInnerSpacingBarMultiplier: 0.25,\n      xOuterSpacingBarMultiplier: 0.5,\n    },\n    bar: {\n      borderRadius: 6,\n      minWidth: 2,\n      maxWidth: 24,\n      spaceMultiplier: 0.25,\n      minSpace: 1,\n      maxSpace: 12,\n    },\n    crosshair: {\n      color: theme.fill800,\n      tickColor: theme.fill800,\n      tickBgColor: theme.fill200,\n      lineColor: theme.fill500,\n      lineDash: [3, 4],\n    },\n    menu: {\n      bgColor: theme.background,\n      borderColor: theme.fill300,\n      borderWidth: 1,\n      borderRadius: 6,\n      padding: 6,\n      item: {\n        padding: 10,\n        fontSize: 13,\n        color: theme.fill700,\n        colorHover: theme.fill900,\n        bgColorHover: theme.backgroundDarker,\n        borderRadius: 6,\n      },\n    },\n    slider: {\n      padding: 16,\n      background: theme.backgroundDarker,\n      border: `1px solid ${theme.fill300}`,\n      borderRadius: 6,\n      filledTrackColor: transparentize(0.9, theme.primary),\n      filledTrackBorderColor: transparentize(0.5, theme.primary),\n      thumbBackground: theme.background,\n      thumbBorder: `1px solid ${theme.fill300}`,\n      thumbHandleLineColor: theme.fill500,\n    },\n  },\n};\n","import map from 'lodash/map';\n\nconst isValidOrdinate = value =>\n  ![null, undefined].includes(value) && !Number.isNaN(value);\n\nexport default function normalizeData(config) {\n  const { data, xKey, yKey } = config;\n\n  if (!data || !data.length || !data[0]?.series) {\n    return [\n      {\n        name: 'Invalid data',\n        series: [\n          {\n            x: null,\n            y: 0,\n          },\n          {\n            x: null,\n            y: 100,\n          },\n        ],\n      },\n    ];\n  }\n\n  return data.map(dataset => {\n    const { name, code, series } = dataset;\n    if (!series?.length) {\n      return {\n        name,\n        code,\n        series,\n      };\n    }\n\n    const hasTheRightKeys = series[0].x && series[0].y;\n    if (hasTheRightKeys) {\n      return {\n        ...dataset,\n        series: map(series, entry => ({\n          x: entry.x,\n          y: isValidOrdinate(entry.y) ? entry.y : 0,\n          meta: entry.meta,\n          color: entry.color,\n        })),\n      };\n    }\n\n    return {\n      name,\n      code,\n      series: map(series, entry => ({\n        x: entry[xKey],\n        y: isValidOrdinate(entry[yKey]) ? entry[yKey] : 0,\n        meta: entry.meta,\n        color: entry.color,\n      })),\n    };\n  });\n}\n","/* eslint-disable no-param-reassign */\nimport Konva from 'konva';\n\nfunction useFrame(config) {\n  const { theme } = config;\n\n  // canvas width & height - padding\n  const inner = {\n    xStart: theme.padding,\n    xEnd: config.width - theme.padding,\n    yStart: theme.padding,\n    yEnd: config.height - theme.padding,\n  };\n\n  // legend\n  const legend = {\n    xStart: theme.padding,\n    yStart: theme.padding + theme.title.fontSize + theme.title.marginBottom,\n    items: [],\n  };\n\n  config.data.forEach((dataset, i) => {\n    const textWidth = Math.ceil(\n      new Konva.Text({\n        text: dataset.name,\n        fontFamily: theme.legend.fontFamily || theme.fontFamily,\n        fontSize: theme.legend.fontSize,\n      }).getTextWidth(),\n    );\n\n    const marginRight =\n      i === config.data.length - 1 ? 0 : theme.legend.itemMarginRight;\n\n    let xStart = i === 0 ? legend.xStart : legend.items[i - 1].xEnd;\n    let yStart = i === 0 ? legend.yStart : legend.items[i - 1].yStart;\n    let xEnd =\n      xStart +\n      theme.legend.circle.size +\n      theme.legend.circle.marginRight +\n      textWidth +\n      marginRight;\n    let yEnd = yStart + theme.legend.fontSize + theme.legend.marginBottom;\n\n    let xInnerStart = xStart;\n    let yInnerStart = yStart;\n    let xInnerEnd = xEnd - marginRight;\n    let yInnerEnd = yEnd - theme.legend.marginBottom;\n\n    if (i > 0 && xInnerEnd > inner.xEnd) {\n      xStart = legend.xStart;\n      yStart = yStart + theme.legend.fontSize + theme.legend.itemMarginBottom;\n      xEnd =\n        xStart +\n        theme.legend.circle.size +\n        theme.legend.circle.marginRight +\n        textWidth +\n        marginRight;\n      yEnd = yStart + theme.legend.fontSize + theme.legend.marginBottom;\n\n      xInnerStart = xStart;\n      yInnerStart = yStart;\n      xInnerEnd = xEnd - marginRight;\n      yInnerEnd = yEnd - theme.legend.marginBottom;\n    }\n\n    legend.items.push({\n      xStart,\n      xEnd,\n      yStart,\n      yEnd,\n      xInnerStart,\n      xInnerEnd,\n      yInnerStart,\n      yInnerEnd,\n    });\n  });\n  legend.yEnd = legend.items[legend.items.length - 1].yEnd;\n\n  const header = {\n    xStart: theme.padding,\n    xEnd: config.width - theme.padding,\n    yStart: theme.padding,\n    yEnd: legend.yEnd,\n  };\n\n  // chart + axes\n  const outerChart = {\n    xStart: inner.xStart,\n    xEnd: inner.xEnd,\n    yStart: header.yEnd,\n    yEnd: inner.yEnd,\n  };\n\n  const lastEntryWidths = config.data.map(dataset => {\n    const lastEntry = dataset.series[dataset.series.length - 1];\n    const textWidth = new Konva.Text({\n      text: config.formatters.axes.y(lastEntry?.y),\n      fontFamily: theme.axes.fontFamily || theme.fontFamily,\n      fontSize: theme.axes.fontSize,\n    }).getTextWidth();\n    return Math.ceil(textWidth);\n  });\n\n  const ySize =\n    theme.axes.tickSize +\n    theme.axes.tickMargin +\n    Math.max(...lastEntryWidths) +\n    theme.axes.tickMargin;\n\n  const xSize =\n    theme.axes.tickSize + theme.axes.tickMargin + theme.axes.fontSize;\n\n  const innerChart = {\n    xStart: inner.xStart,\n    xEnd: inner.xEnd - ySize,\n    width: inner.xEnd - ySize - inner.xStart,\n    yStart: header.yEnd,\n    yEnd: inner.yEnd - xSize,\n    height: inner.yEnd - xSize - header.yEnd,\n  };\n\n  const xAxis = {\n    xStart: innerChart.xStart,\n    xEnd: innerChart.xEnd,\n    yStart: innerChart.yEnd,\n    yEnd: innerChart.yEnd,\n  };\n\n  const yAxis = {\n    xStart: innerChart.xEnd,\n    xEnd: outerChart.xEnd,\n    yStart: innerChart.yStart,\n    yEnd: innerChart.yEnd,\n  };\n\n  return {\n    inner,\n    header,\n    legend,\n    outerChart,\n    innerChart,\n    xAxis,\n    yAxis,\n  };\n}\n\nexport default useFrame;\n","import maxBy from 'lodash/maxBy';\nimport { scaleLinear, scaleBand } from 'd3-scale';\n\nexport default function useScales(frame, config) {\n  if (config.sharedScale) {\n    const xScale = scaleBand()\n      .domain(\n        maxBy(config.data, data => data.series.length).series.map(({ x }) => x),\n      )\n      .range([frame.innerChart.xStart, frame.innerChart.xEnd])\n      .paddingInner(config.theme.axes.xInnerSpacingBarMultiplier)\n      .paddingOuter(config.theme.axes.xOuterSpacingBarMultiplier);\n\n    const ySeries = config.data\n      .map(({ series }) => series.map(({ y }) => y))\n      .flat(1);\n\n    const yScale = scaleLinear()\n      .domain([Math.min(...ySeries, 0), Math.max(...ySeries, 0)])\n      .range([frame.innerChart.yEnd, frame.innerChart.yStart])\n      .nice();\n\n    return [\n      {\n        x: xScale,\n        y: yScale,\n      },\n    ];\n  }\n\n  const scales = config.data.map(({ series }) => {\n    const xScale = scaleBand()\n      .domain(series.map(({ x }) => x))\n      .range([frame.innerChart.xStart, frame.innerChart.xEnd])\n      .paddingInner(config.theme.axes.xInnerSpacingBarMultiplier)\n      .paddingOuter(config.theme.axes.xOuterSpacingBarMultiplier);\n\n    const ySeries = series.map(({ y }) => y);\n    const yScale = scaleLinear()\n      .domain([Math.min(0, ...ySeries), Math.max(0, ...ySeries)])\n      .range([frame.innerChart.yEnd, frame.innerChart.yStart])\n      .nice();\n\n    return {\n      x: xScale,\n      y: yScale,\n    };\n  });\n\n  return scales;\n}\n","/* eslint-disable no-multi-assign */\nfunction onVisibilityChange(callback) {\n  var visible = true;\n\n  if (!callback) {\n    throw new Error('no callback given');\n  }\n\n  function focused() {\n    if (!visible) {\n      callback((visible = true));\n    }\n  }\n\n  function unfocused() {\n    if (visible) {\n      callback((visible = false));\n    }\n  }\n\n  // Standards:\n  if ('hidden' in document) {\n    visible = !document.hidden;\n    document.addEventListener('visibilitychange', function() {\n      (document.hidden ? unfocused : focused)();\n    });\n  }\n  if ('mozHidden' in document) {\n    visible = !document.mozHidden;\n    document.addEventListener('mozvisibilitychange', function() {\n      (document.mozHidden ? unfocused : focused)();\n    });\n  }\n  if ('webkitHidden' in document) {\n    visible = !document.webkitHidden;\n    document.addEventListener('webkitvisibilitychange', function() {\n      (document.webkitHidden ? unfocused : focused)();\n    });\n  }\n  if ('msHidden' in document) {\n    visible = !document.msHidden;\n    document.addEventListener('msvisibilitychange', function() {\n      (document.msHidden ? unfocused : focused)();\n    });\n  }\n  // IE 9 and lower:\n  if ('onfocusin' in document) {\n    document.onfocusin = focused;\n    document.onfocusout = unfocused;\n  }\n  // All others:\n  window.onpageshow = window.onfocus = focused;\n  window.onpagehide = window.onblur = unfocused;\n}\n\nexport default onVisibilityChange;\n"],"mappings":"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","names":["inRange","maxBy","React","useEffect","useRef","useState","Div","React","useEffect","useRef","useState","keys","preventDefault","preventDefaultForScrollKeys","supportsPassive","wheelOpt","wheelEvent","disableScroll","enableScroll","get","useEffect","useState","useSize","ref","dependencyArray","fallback","size","setSize","observer","el","entries","Thumb","left","right","value","scale","max","onMove","theme","props","deltaRef","useRef","handleMouseMove","event","isTouch","dx","nextX","nextValue","handlePointerDown","disableScroll","enableScroll","React","Div","ControlSlider","onInput","ref","scaleRef","scaleLoaded","setScaleLoaded","useState","width","useSize","leftValue","rightValue","useEffect","scaleLinear","React","React","forwardRef","KonvaStage","KonvaLayer","KonvaGroup","KonvaRect","KonvaCircle","KonvaText","KonvaLine","KonvaImage","Stage","props","ref","Layer","Group","Rect","Circle","Text","Line","Image","React","useReactContext","Context","useContext","Konva","React","forwardRef","isNil","fromEntries","entries","removeNilDeep","entity","value","key","removeNilDeep_default","Text","props","ref","config","useContext","textProps","removeNilDeep_default","getWidth","Konva","React","Rect","Text_default","forwardRef","Header","frame","config","setActiveScale","setCursor","useContext","React","Text_default","dataset","index","xStart","yStart","color","Group","Circle","Rect","Header_default","mix","React","useEffect","useRef","getBarCoordinate","config","scale","stepWidth","bars","barSpace","barStepWidth","barWidth","datasetI","x","getZOrderedDatasets","config","activeScale","zOrderedDatasets","dataset","index","i","useEffect","useRef","useCallback","Konva","isValidCoordinate","value","isValidNode","type","attrs","useRenderer","layer","config","frame","useContext","queue","useRef","ref","handleRender","useCallback","renderFn","props","key","show","node","children","child","i","groupNode","Konva","childNode","useEffect","renderer","inRange","React","useEffect","useState","React","mix","YTick","y","text","fill","onClick","frame","config","setCursor","useContext","bgSize","React","Group","Line","mix","Text_default","YTick_default","id","isTouchDevice","getClosestBarByX","config","scales","x","closest","di","dataset","scale","barWidth","getBarX","getBarCoordinate","i","xCenter","diff","Crosshair","frame","activeScale","on","off","tool","useContext","pos","setPos","useState","fixedPos","setFixedPos","y","xText","xInRange","inRange","closestPoint","yText","useEffect","inInnerChartRange","evt","React","Line","Text_default","YTick_default","Crosshair_default","React","useState","useRef","useEffect","useCallback","keys","values","fromEntries","entries","id","LineDrawing","line","selectedLine","setSelectedLine","setMovingLine","mousePos","frame","config","setCursor","useContext","isHovering","setIsHovering","useState","points","React","Group","Line","Circle","LineDrawings","tool","setTool","on","off","menuItems","setMenuItems","mouseDeltaRef","useRef","setMousePos","lines","setLines","movingLine","eventsActive","addLine","useCallback","x","y","lastLineId","lastLine","lineId","moveLine","point","deltaRef","useEffect","inInnerChartRange","evt","removePendingLine","event","pendingLine","LineDrawings_default","React","useState","useEffect","id","MenuItem","x","y","children","onClick","config","setCursor","useContext","isHover","setIsHover","useState","React","Group","Rect","Text_default","Menu","on","off","menuItems","pos","setPos","show","setShow","itemHeight","items","width","useEffect","e","menuItem","i","Menu_default","jstr","renderLine","stroke","strokeWidth","points","renderBar","width","height","x","y","fill","cornerRadius","InnerChart","layerRef","renderer","useRenderer","prevBarsRef","useRef","frame","scales","config","activeScale","setCursor","dispatch","useContext","data","getZOrderedDatasets","useEffect","barKeys","dataset","i","scale","barWidth","getBarX","getBarCoordinate","entry","key","color","j","prevKey","isPositive","mix","React","Rect","event","Crosshair_default","LineDrawings_default","Menu_default","InnerChart_default","React","Html","MobileDivOverlay","config","useContext","React","Layer","Html","React","useRef","Konva","XAxis","frame","config","scales","activeScale","useContext","xTickxEnd","useRef","React","entry","i","x","text","Konva","Group","Line","Text_default","XAxis_default","React","useRef","YAxis","frame","config","scales","activeScale","setActiveScale","useContext","yTickyEnd","useRef","React","tick","i","y","Group","Line","Text_default","getZOrderedDatasets","dataset","index","lastValue","lastY","YTick_default","YAxis_default","useRef","values","keys","useCallbacks","callbacks","event","payload","fn","callback","id","key","useCallbacks_default","deepmerge","round","moment","transparentize","theme","defaultConfig_default","value","decimals","map","isValidOrdinate","value","normalizeData","config","data","xKey","yKey","dataset","name","code","series","entry","useConfig","instanceConfig","config","deepmerge","defaultConfig_default","removeNilDeep_default","normalizeData","Konva","useFrame","config","theme","inner","legend","dataset","i","textWidth","marginRight","xStart","yStart","xEnd","yEnd","xInnerStart","yInnerStart","xInnerEnd","yInnerEnd","header","outerChart","lastEntryWidths","lastEntry","ySize","xSize","innerChart","xAxis","yAxis","useFrame_default","maxBy","scaleLinear","scaleBand","useScales","frame","config","xScale","data","x","ySeries","series","y","yScale","onVisibilityChange","callback","visible","focused","unfocused","visibilityChange_default","Chart","fwdRef","title","data","cfg","slider","layerRef","useRef","barData","setBarData","useState","config","useConfig","frame","useFrame_default","scales","useScales","dispatch","on","off","useCallbacks_default","cursor","setCursor","menuItems","setMenuItems","activeScale","setActiveScale","renderKey","setRenderKey","steps","maxBy","dataSeries","slices","setSlices","sliceStart","sliceEnd","useEffect","renderCount","visibilityChange_default","visible","context","konvaEvent","e","inRange","React","Stage","Context","Layer","Rect","Header_default","XAxis_default","YAxis_default","InnerChart_default","MobileDivOverlay","ControlSlider","v","min","max","Chart_default"]}